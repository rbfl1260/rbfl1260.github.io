---
layout: single
title: "슈트라센"
date:	2020-04-09 18:08:00 +0900
---

슈트라센 알고리즘은 두 정수를 매우 빠르게 곱할 수 있는 알고리즘으로 1969년 독일의 수학자 *폴커 슈트라센*에 의해 개발된 행렬 곱셈 알고리즘이다. 

- # **일반적인 행렬의 곱셉** 

  크기가 n *n인 두 행렬 A와 B의 곱을 C로 나타내고자 할 때 A의 원소를 m(ij), B의 원소를 n(ij)라 하고, i는 가로 j는 세로를 나타낸다.

  

  ![](https://user-images.githubusercontent.com/62733778/79068046-d7a9fa80-7cfe-11ea-9927-6b5ea4413241.jpg)

  위의 행렬 곱셈을 다음과 같이도 표현할 수 있다. 

  ![](https://user-images.githubusercontent.com/62733778/79068036-ccef6580-7cfe-11ea-8052-64f57f4a910d.jpg)

  

  C하나의 원소를 구하는데 곱셈 n번과 덧셈 n-1이 필요하므로 C전체를 구할 경우에는 곱셈은 n^3, 덧셈은 n^2(n-1)이 필요하다.

  그러므로 8번의 곱셈과 4번의 덧셈이 필요함을 알 수 있다.

  - ## **일반적인 행렬의 시간 복잡도 구하기**

    n * n의 정사각행렬의 크기가 2^k * 2^k라고 하면 행렬의 곱셈은 n/2 * n/2 크기의 행렬을 8번 곱하고 n/2 * n/2 크기의 행렬을 4번 더한다는 것을 알 수 있다. 

    한번 계산하는데 걸리는 시간이 T(n)이라고 하고 빅오 표기법에 의해 덧셈은 생략되므로 곱하기만 계산하여 시간복잡도를 계산하면

    t(n) = 8 * T(n/2)

    ​		= 8 [8 * T(n/4)]

    ​		...

    ​		= 8^logn = 2^3logn = n^3

    ​		= O(n^3)

    그러므로 시간복잡도는 O(n^3)이 된다.

  - ## **일반적인 행렬곱의 소스코드**

    ![](https://user-images.githubusercontent.com/62733778/79068118-5ef76e00-7cff-11ea-82b4-063f2e556f48.PNG)

- # **슈트라센 알고리즘**

  행렬 A와 행렬 B의 곱이 행렬 C라고 할 때, A와 B는 2^k * 2^k꼴의 크기이다(n * n의 정사각행렬의 크기는 2^k * 2^k). 2^k * 2^k의 꼴이 아닐 때는 0으로 채워진 가로, 세로 줄을 추가하여  2^k * 2^k의 꼴로 만들어준다.

  ![](https://dthumb-phinf.pstatic.net/?src=%22https%3A%2F%2Fssl.pstatic.net%2Fimages.se2%2Fsmedit%2F2015%2F10%2F7%2Fifgm9ch32b5ok9.jpg%22&type=w2)

  따라서 슈트라센 알고리즘에 의해 아래의 7개의 수식으로 곱 C를 표현할 수 있다.

  ***M1 = (A11+A22)(B11+B22)***

  ***M2 = (A21+A22)B11***

  ***M3 = A11(B12-B22)***

  ***M4 = A22(B21-B11)***

  ***M5 = (A11+A12)B22***

  ***M6 = (A21-A11)(B11+B12)***

  ***M7 = (A12-A22)(B21+B22)***

  

  C행렬을 M1~M7을 가지고 표현하면 아래와 같다.

  ***C11 = M1+M4-M5+M7***

  ***C12 = M3+M5***

  ***C21 = M2+M4***

  ***C22 = M1-M2+M3+M6***

  일반적인 행렬의 곱은 8번의 곱셈과 4번의 덧셈을 필요로 했지만, 슈트라센 알고리즘을 이용한 행렬의 곱은 7번의 곱셈과 18번의 덧셈을 필요로 한다.

  큰 행렬에서는 곱셈이 덧셈보다 더 많은 시간을 필요로 하기 때문에 슈트라센 알고리즘이 훨씬 효율적이다.

  

  - ## **슈트라센 알고리즘 시간 복잡도 구하기**

    n/2 * n/2 크기의 행렬을 7번 곱하고 n/2 * n/2크기의 행렬을 18번 더한다. 한번 계산할 때 걸리는 시간이 T(n)이라고 하고, 더하기는 빅오 표기법에 의해 생략되므로 곱하기만을 계산하여 시간복잡도를 구하면

    t(n) = 7 * T(n/2)

    ​		= 7[7 * T(n/4)]

    ​		...

    ​		=O(n^2.807)

    그러므로 시간 복잡도는 O(n^2.807)가 된다.

    따라서 슈트라센 알고리즘은 일반적인 행렬의 곱에 비해 더 낮은 시간 시간 복잡도를 보여준다.

  - ## **슈트라센 알고리즘 행렬곱의 소스코드**

    ![](https://user-images.githubusercontent.com/62733778/79069853-738e3300-7d0c-11ea-848d-7e762225e038.PNG)

